````markdown
# Detailed Vulnerability Analysis

## Purpose
This document provides **in-depth technical details** for key vulnerabilities identified during the Pre-Cloud Web Application Security Assessment.

It complements the high-level findings by explaining:
- Root cause
- Attack scenario
- Exploitation flow
- Technical remediation rationale

---

## 1. SQL Injection in Search Functionality (CRIT-001)

### Root Cause
User-controlled input is directly concatenated into SQL queries without parameterization or sanitization.

### Attack Scenario
1. Attacker identifies injectable parameter `q`
2. Crafts UNION-based SQL payload
3. Backend executes injected query
4. Database returns sensitive user data

### Exploitation Example
```sql
apple')) UNION SELECT id, email, password FROM Users--
````

### Impact Analysis

* Full database disclosure
* Credential compromise
* Potential lateral movement

### Why This Is Critical

SQL injection provides **direct control over backend data**, often leading to complete system compromise.

---

## 2. Authentication Bypass via JWT Manipulation (CRIT-002)

### Root Cause

JWT verification does not enforce allowed cryptographic algorithms.

### Attack Scenario

1. Attacker decodes JWT header
2. Changes `alg` value to `none`
3. Removes signature
4. Application accepts forged token

### Exploitation Flow

```text
Header: { "alg": "none", "typ": "JWT" }
Payload: { "role": "admin" }
```

### Impact Analysis

* Privilege escalation
* Admin access without credentials
* Complete authorization bypass

---

## 3. Remote Code Execution via File Upload (CRIT-003)

### Root Cause

Uploaded files are not validated for type, content, or execution permissions.

### Attack Scenario

1. Attacker uploads malicious script
2. File stored in executable directory
3. Script accessed via browser
4. Server executes attacker-controlled code

### Impact Analysis

* Full server takeover
* Data exfiltration
* Persistence mechanisms

---

## 4. Command Injection in Admin Panel (CRIT-004)

### Root Cause

User input is passed directly to system shell commands.

### Attack Scenario

1. Attacker submits crafted command
2. Backend executes OS-level command
3. System privileges abused

### Exploitation Example

```bash
; cat /etc/passwd
```

### Impact Analysis

* Arbitrary command execution
* Backdoor installation
* Data destruction

---

## 5. Exposed Database Credentials (CRIT-005)

### Root Cause

Credentials hardcoded in client-side JavaScript.

### Attack Scenario

1. Attacker views page source
2. Extracts database credentials
3. Connects directly to database

### Impact Analysis

* Unauthorized database access
* Data manipulation
* Complete loss of confidentiality

---

## 6. Stored Cross-Site Scripting (HIGH-001)

### Root Cause

User input stored without sanitization and rendered without encoding.

### Attack Scenario

1. Attacker submits malicious script
2. Script stored in database
3. Other users load affected page
4. Script executes in victim’s browser

### Exploitation Example

```html
<script>alert(document.cookie)</script>
```

### Impact Analysis

* Session hijacking
* Credential theft
* User impersonation

---

## 7. Insecure Direct Object Reference (HIGH-002)

### Root Cause

Authorization checks are missing for object access.

### Attack Scenario

1. User modifies object ID in request
2. Backend returns another user’s data
3. Privacy breach occurs

### Impact Analysis

* Data exposure
* Compliance violations

---

## 8. Missing Rate Limiting (HIGH-004)

### Root Cause

No request throttling implemented on sensitive endpoints.

### Attack Scenario

1. Attacker performs automated login attempts
2. No rate limit blocks requests
3. Credentials are brute-forced

### Impact Analysis

* Account compromise
* Service abuse

---

## 9. Security Misconfiguration (MED-002)

### Root Cause

Default configurations and missing security headers.

### Attack Scenario

* Clickjacking via iframes
* MIME sniffing
* Weak browser protections

### Impact Analysis

* Reduced defense-in-depth
* Increased attack success rate

---

## 10. Insufficient Logging & Monitoring (MED-009)

### Root Cause

Security events are not logged or monitored.

### Attack Scenario

* Attacks occur without detection
* No audit trail for investigation

### Impact Analysis

* Delayed incident response
* Compliance gaps

---

## Summary

The vulnerabilities identified share common themes:

* Lack of input validation
* Weak authentication controls
* Insecure defaults
* Missing defense-in-depth mechanisms

Addressing root causes rather than symptoms is essential to achieving **cloud-ready security posture**.
